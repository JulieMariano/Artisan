// Close the Modal
document.querySelector('#ModalCategoryNew button').click();

// Remove the Modal's background shadow
document.querySelector('body').classList.remove('modal-open');
document.querySelector('.modal-backdrop').remove();

// If there are errors update the Modal with validation errors and then open it
<% if @category.errors.any? %>
  $('#ModalCategoryNew').replaceWith("<%= j render "admin/categories/form", category: @category %>");

  document.querySelector("[data-target='#ModalCategoryNew']").click();

// Otherwise clean the Modal and then append the new Category row to the list
<% else %>
  $('#ModalCategoryNew').replaceWith("<%= j render "admin/categories/form", category: Category.new %>");

  $('tbody').append("<%= j render "admin/categories/category", category: @category %>");
<% end %>
