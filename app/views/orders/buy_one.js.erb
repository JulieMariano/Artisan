// If a flash alert already exists, then remove it
var flash = document.querySelector('.alert.alert-dismissible');
if (flash) { flash.remove() }

// If there are any erros in the creation of an order, then display a warning alert
<% if @order.errors.any? %>
  createFlashes('alert-warning', "It seems there was an error with your order");
<% else %>
  // Refresh the Order Checkout Modal content
  document.querySelector('#ModalCheckout').innerHTML = "<%= j render partial: "orders/modal-checkout" %>";

  // Use jQuery to open the Checkout Modal
  $("#ModalCheckout").modal('show');

  var paymentButton = document.getElementById('pay');
  paymentButton.addEventListener('click', () => {
    const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
    stripe.redirectToCheckout({
      sessionId: '<%= @order.checkout_session_id %>'
    });
  });
<% end %>
